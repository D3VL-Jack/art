<!DOCTYPE html>
<html lang="en">
  <head> 
      <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Spreadsheet Search</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <!-- Special version of Bootstrap that only affects content wrapped in .bootstrap-iso -->
<link rel="stylesheet" href="https://formden.com/static/cdn/bootstrap-iso16.css" /> 

<!-- Inline CSS based on choices in "Settings" tab -->
<style>.bootstrap-iso .form-group button, .bootstrap-iso form input.form-control, .bootstrap-iso form textarea.form-control, .bootstrap-iso form select.form-control, .bootstrap-iso form .form-group-lg input.form-control, .bootstrap-iso form .form-group-lg textarea.form-control, .bootstrap-iso form .form-group-lg select.form-control, .bootstrap-iso form .form-group-sm input.form-control, .bootstrap-iso form .form-group-sm textarea.form-control, .bootstrap-iso form .form-group-sm select.form-control{-webkit-border-radius: 20px;-moz-border-radius: 20px; border-radius: 20px;}.bootstrap-iso .formden_header h2, .bootstrap-iso .formden_header p, .bootstrap-iso form{font-family: Arial, Helvetica, sans-serif; color: black}.bootstrap-iso form button, .bootstrap-iso form button:hover{color: #ffffff !important;}.bootstrap-iso .form-control:focus { border-color: #5bc0de; -webkit-box-shadow: none; box-shadow: none;} .bootstrap-iso .has-error .form-control:focus{-webkit-box-shadow: none; box-shadow: none;} .asteriskField{color: red;}.bootstrap-iso form .input-group-addon {color:#555555; background-color: #eeeeee; border-radius: 20px; padding-left:15px}</style>

  
  </head>
  <body>
    <p id="food"></p>
    <script type="text/javascript">

     var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRDkvQQFQ_7x5bSb2q2eGwxuRJ-Wf50de_Wp1Kbf5F0I_h3M1fAnnLJfGzmP3reraU6SiM0qrKBw1s6/pub?gid=1048722892&single=true&output=csv';
     // var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRB4E_6RnpLP1wWMjqcwsUvotNATB8Np3OntlXb7066ULcAHI9oqqRhucltFifPTYNd7DRNRE56oTdt/pub?output=csv';

      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: showInfo
        })
      }

      window.addEventListener('DOMContentLoaded', init)

      function showInfo(results) {
        var data = results.data

        // data comes through as a simple array since simpleSheet is turned on
        alert("Successfully processed " + data.length + " rows!")
        document.getElementById("food").innerHTML = "<strong>Example:</strong> " + [ data[0].Name, data[1].Name, data[2].Name ].join(", ");
        console.log(data);
      }

      document.write("The published spreadsheet is located at <a target='_new' href='" + public_spreadsheet_url + "'>" + public_spreadsheet_url + "</a>");        
    </script>
    <p><strong>This example is only going to work if it's on the internet or on a local server!</strong> To run a local server, run "terminal" or "command prompt" and run the command <code>python -m http.server</code> or <code>python -m SimpleHTTPServer</code> (whichever one works, really, and you might even need to <a href="http://littlecolumns.com/tools/python-wrangler/">install Python</a>). Then visit <a href="http://localhost:8000/">http://localhost:8000</a> and you'll be all set.</p>
 



    <h1>Google Spreadsheet Search</h1>
   
      <!-- HTML Form (wrapped in a .bootstrap-iso div) -->
<div class="bootstrap-iso">
 <div class="container-fluid">
  <div class="row">
   <div class="col-md-6 col-sm-6 col-xs-12">

      <form class="form-horizontal" id="searchForm">
    <!-- //script.google.com/a/macros/chrome.escg.ac.uk/s/AKfycbzTg3_SZjTYuOsPAgCoegOwiWqn8QVAl3McwibkRAd52S0qEWKFOPAukYbJX3yhHV8/exec" -->


     <div class="form-group form-group-lg">
      <label class="control-label col-sm-2" for="search">
       Search
      </label>
      <div class="col-sm-10">


       <input class="form-control"  name="search" type="text" id="searchInput" placeholder="Enter keyword"/>
      </div>
     </div>
     <div class="form-group">
      <div class="col-sm-10 col-sm-offset-2">
     
       <button class="btn btn-info btn-lg btn-block" name="submit" type="submit">
        Search
       </button>
      </div>
     </div>
    </form>
   </div>
  </div>
 </div>
</div>


      
    </form>
    <div id="results"></div>

   <script>
        document.getElementById('searchForm').addEventListener('submit', function(event) {
            event.preventDefault();
            var searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            searchGoogleSpreadsheet(searchTerm);
        });

        function searchGoogleSpreadsheet(keyword) {
            Papa.parse(public_spreadsheet_url, {
                download: true,
                header: true,
                complete: function(results) {
                    displayResults(results.data, keyword);
                }
            });
        }

        function displayResults(data, keyword) {
            var resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '';

            var filteredData = data.filter(function(item) {
                return item.Name.toLowerCase().includes(keyword) || item.Theme.toLowerCase().includes(keyword);
            });

            filteredData.forEach(function(item) {
                var nameElement = document.createElement('p');
                nameElement.textContent = "Name: " + item.Name;

                var imageElement = document.createElement('img');
                imageElement.src = item['Upload Image:']; // Use item['Upload Image:'] to access the 'Upload Image' field

                var container = document.createElement('div');
                container.appendChild(nameElement);
                container.appendChild(imageElement);

                resultsDiv.appendChild(container);
            });
        }
    </script>
</body>
</html>
    
